apiVersion: v1
kind: ConfigMap
metadata:
  name: postgres-config
  namespace: trainer
data:
  init.sql: |
    CREATE TABLE IF NOT EXISTS uploaded_files (
        id SERIAL PRIMARY KEY,
        filename VARCHAR(255) NOT NULL,
        mimetype VARCHAR(100),
        file_data BYTEA NOT NULL,
        gemini_file_id VARCHAR(500),
        uploaded_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
    );
    
    CREATE INDEX IF NOT EXISTS idx_filename ON uploaded_files(filename);
    CREATE INDEX IF NOT EXISTS idx_uploaded_at ON uploaded_files(uploaded_at);
